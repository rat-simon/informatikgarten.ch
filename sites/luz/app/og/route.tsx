/* eslint react/no-unknown-property: ['error', { ignore: ['tw'] }] */
import { ImageResponse } from 'next/og'

export const runtime = 'edge'

// eslint-disable-next-line unicorn/prefer-top-level-await -- this will break og image
// TODO: Add font to image
// const font = fetch(new URL('Inter-SemiBold.otf', import.meta.url)).then(res =>
//     res.arrayBuffer()
// )

export async function GET(req: Request): Promise<Response> {
    try {
        const { searchParams } = new URL(req.url)

        // ?title=<title>
        const title =
            searchParams.get('title')?.slice(0, 75) || ''

        return new ImageResponse(
            (
                <div
                    style={{
                        height: '100%',
                        width: '100%',
                        display: 'flex',
                        flexDirection: 'column',
                        alignItems: 'flex-start',
                        justifyContent: 'center',
                        padding: '200px 320px',
                        backgroundColor: '#202020',
                        backgroundSize: '100px 100px',
                        backgroundPosition: '-30px -10px',
                        fontWeight: 600
                    }}
                >
                    <svg
                        id="logo-url"
                        style={{ position: 'absolute', top: 70, left: 300 }}
                        xmlns="http://www.w3.org/2000/svg"
                        viewBox="0 0 319.69 78.79"
                        width="500px"
                    >
                        <path
                            d="M30.18,48.75c-.61,0-1.11-.49-1.11-1.11v-4.69l-5.97-1.79-4.21-3.59,10.18,3.05v-.68c0-2.46.69-4.89,2.07-6.96.41-.62.75-1.28,1.02-1.97l-5.45-1.63-6.34-4.23,12.38,3.71c.09-.57.14-1.15.14-1.73v-5.16h2.21v5.16c0,.28,0,.57-.03.85l9.54-2.85-7.38,4.54-2.56.77c-.35,1.31-.9,2.56-1.66,3.71-1.13,1.72-1.72,3.74-1.72,5.8v2.44l10.16-3.04-6.24,4.2-3.92,1.17v2.93c0,.61-.49,1.11-1.11,1.11Z"
                            fill="#44911b"
                        />
                        <path
                            d="M33.63,6.54c-4.51,5.24-4.64,13.88-.29,19.3.2.24.53.27.73.03,4.51-5.24,4.64-13.88.29-19.3-.2-.27-.53-.27-.73-.03Z"
                            fill="#86d72f"
                        />
                        <path
                            d="M17.02,29.79l-8.61-2.58c-1.45,4.84,1.3,9.94,6.12,11.41l8.61,2.58c1.48-4.84-1.28-9.96-6.12-11.41Z"
                            fill="#86d72f"
                        />
                        <path
                            d="M49.93,29.56l-8.61,2.58c-4.84,1.48-7.6,6.57-6.12,11.41l8.61-2.58c4.82-1.48,7.57-6.57,6.12-11.41Z"
                            fill="#86d72f"
                        />
                        <path
                            d="M20.64,18.01l-8.61-2.58c-1.43,4.84,1.3,9.94,6.15,11.41l8.61,2.58c1.45-4.84-1.3-9.96-6.15-11.41Z"
                            fill="#86d72f"
                        />
                        <path
                            d="M51.94,15.69l-8.61,2.58c-4.84,1.45-7.6,6.54-6.12,11.41l8.61-2.58c4.82-1.48,7.57-6.57,6.12-11.41Z"
                            fill="#86d72f"
                        />
                        <path
                            d="M44.92,50.62c-4.09-3.07-9.22-4.92-14.76-4.92s-10.66,1.84-14.76,4.92l14.76,4.84,14.76-4.84Z"
                            fill="#7d4533"
                        />
                        <path
                            d="M12.96,60.45l1.92,11.53c.32,1.87,1.92,3.22,3.79,3.22h22.99c1.87,0,3.49-1.35,3.79-3.22l1.94-11.53-17.21-3.91-17.21,3.91Z"
                            fill="#f3ad61"
                        />
                        <path
                            d="M48.6,60.46H11.72c-.69,0-1.23-.54-1.23-1.23v-7.38c0-.69.54-1.23,1.23-1.23h36.89c.69,0,1.23.54,1.23,1.23v7.38c0,.69-.54,1.23-1.23,1.23Z"
                            fill="#f3c07b"
                        />
                        <g fill="#fff">
                            <path d="M75.6,38.09c-.5-.5-.75-1.13-.75-1.88s.24-1.41.73-1.9c.49-.49,1.12-.73,1.9-.73s1.4.24,1.88.73c.48.49.71,1.12.71,1.9s-.24,1.38-.73,1.88c-.49.5-1.11.75-1.86.75s-1.38-.25-1.88-.75ZM75.3,57.77c-.08-.08-.12-.17-.12-.28v-16.31c0-.11.04-.21.12-.28s.17-.12.28-.12h3.89c.11,0,.21.04.28.12.08.08.12.17.12.28v16.31c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12Z" />
                            <path d="M93.76,42.01c.75,1,1.13,2.4,1.13,4.19v11.29c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-10.92c0-.64-.13-1.14-.38-1.5-.26-.35-.63-.53-1.12-.53s-.9.18-1.18.55c-.28.37-.42.88-.42,1.55v10.85c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-16.31c0-.11.04-.21.12-.28s.17-.12.28-.12h3.9c.11,0,.21.04.28.12s.12.17.12.28v.63c0,.07.03.1.08.1s.13-.04.22-.13c.71-.84,1.7-1.26,2.96-1.26,1.51,0,2.64.5,3.4,1.5Z" />
                            <path d="M105.13,40.89c.08.08.12.17.12.28v2.5c0,.11-.04.21-.12.28s-.17.12-.28.12h-1.83c-.11,0-.17.06-.17.17v13.25c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.86c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-13.25c0-.11-.06-.17-.17-.17h-1c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-2.5c0-.11.04-.21.12-.28s.17-.12.28-.12h1c.11,0,.17-.06.17-.17v-.9c0-2,.5-3.38,1.51-4.14,1.01-.77,2.61-1.13,4.81-1.08h.13c.11,0,.21.04.28.12s.12.17.12.28l-.03,2.66c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-.07c-1.13.02-1.7.71-1.7,2.06v.6c0,.11.05.17.17.17h1.83c.11,0,.21.04.28.12Z" />
                            <path d="M108.66,56.65c-1.12-1-1.68-2.36-1.68-4.09v-6.46c0-1.69.57-3.04,1.7-4.06,1.13-1.02,2.67-1.53,4.63-1.53s3.53.51,4.66,1.53c1.13,1.02,1.7,2.38,1.7,4.06v6.46c0,1.73-.56,3.1-1.68,4.09-1.12,1-2.68,1.5-4.68,1.5s-3.52-.5-4.64-1.5ZM114.5,53.56c.31-.36.47-.81.47-1.37v-5.76c0-.55-.16-1.01-.47-1.37-.31-.35-.71-.53-1.2-.53s-.88.18-1.18.53c-.3.36-.45.81-.45,1.37v5.76c0,.55.15,1.01.45,1.37.3.35.69.53,1.18.53s.89-.18,1.2-.53Z" />
                            <path d="M130.98,40.91c.18.11.24.28.2.5l-.63,3.9c-.02.24-.18.33-.47.27-.24-.09-.54-.13-.9-.13-.33,0-.62.04-.87.13-.51.09-.92.39-1.23.92-.31.52-.47,1.13-.47,1.81v9.15c0,.11-.04.21-.12.28s-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-16.28c0-.11.04-.21.12-.28s.17-.12.28-.12h3.9c.11,0,.21.04.28.12s.12.17.12.28v1.3c0,.09.02.14.05.15s.07-.02.12-.08c.6-1.31,1.53-1.96,2.8-1.96.6,0,1.06.11,1.4.33Z" />
                            <path d="M151.65,42.04c.75,1.02,1.13,2.45,1.13,4.29v11.15c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-10.85c0-.67-.13-1.18-.4-1.55s-.62-.55-1.07-.55c-.49,0-.87.18-1.15.55s-.42.88-.42,1.55v10.85c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.86c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-10.85c0-.67-.13-1.18-.4-1.55-.27-.37-.62-.55-1.07-.55-.49,0-.87.18-1.15.55-.28.37-.42.88-.42,1.55v10.85c0,.11-.04.21-.12.28s-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-16.31c0-.11.04-.21.12-.28s.17-.12.28-.12h3.9c.11,0,.2.04.28.12.08.08.12.17.12.28v.43c0,.07.02.11.07.13.04.02.09.01.13-.03.44-.44.93-.75,1.46-.93s1.04-.27,1.53-.27c1.73,0,2.97.69,3.73,2.06l.07.03c.07,0,.14-.07.23-.2.47-.71,1.03-1.2,1.68-1.48.65-.28,1.32-.42,1.98-.42,1.51,0,2.64.51,3.4,1.53Z" />
                            <path d="M165.96,42.04c1.18,1.02,1.76,2.36,1.76,4.03v11.42c0,.11-.04.21-.12.28s-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-.73c0-.07-.02-.11-.07-.13-.04-.02-.09,0-.13.07-.73.93-1.86,1.42-3.4,1.46-1.29,0-2.4-.36-3.35-1.07-.94-.71-1.42-2.06-1.42-4.06s.57-3.48,1.71-4.26c1.14-.78,2.79-1.17,4.94-1.17h1.53c.11,0,.17-.06.17-.17v-.83c0-.6-.16-1.09-.48-1.48-.32-.39-.73-.58-1.21-.58-.38,0-.69.12-.95.35-.25.23-.42.56-.48.98-.02.27-.17.4-.43.4l-4-.03c-.27,0-.4-.13-.4-.4.11-1.62.74-2.91,1.9-3.88,1.15-.97,2.62-1.45,4.39-1.45,1.89,0,3.42.51,4.59,1.53ZM162.42,54.01c.41-.34.62-.8.62-1.38v-1.56c0-.11-.06-.17-.17-.17h-1.37c-.6,0-1.08.17-1.45.52s-.55.82-.55,1.42c0,.55.14.98.42,1.26.28.29.65.43,1.12.43.51,0,.97-.17,1.38-.52Z" />
                            <path d="M177.7,43.95c-.08.08-.17.12-.28.12h-1.86c-.11,0-.17.06-.17.17v7.92c0,.64.12,1.09.37,1.33.24.25.61.36,1.1.33h.23c.11,0,.21.04.28.12s.12.17.12.28v3.26c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-1.33c-1.62,0-2.84-.27-3.66-.82-.82-.54-1.23-1.58-1.23-3.11v-9.72c0-.11-.06-.17-.17-.17h-1.1c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-2.5c0-.11.04-.21.12-.28.08-.08.17-.12.28-.12h1.1c.11,0,.17-.06.17-.17v-3.69c0-.11.04-.21.12-.28s.17-.12.28-.12h3.73c.11,0,.21.04.28.12.08.08.12.17.12.28v3.69c0,.11.06.17.17.17h1.86c.11,0,.21.04.28.12.08.08.12.17.12.28v2.5c0,.11-.04.21-.12.28Z" />
                            <path d="M180.19,38.09c-.5-.5-.75-1.13-.75-1.88s.24-1.41.73-1.9c.49-.49,1.12-.73,1.9-.73s1.4.24,1.88.73c.48.49.71,1.12.71,1.9s-.24,1.38-.73,1.88c-.49.5-1.11.75-1.86.75s-1.38-.25-1.88-.75ZM179.89,57.77c-.08-.08-.12-.17-.12-.28v-16.31c0-.11.04-.21.12-.28s.17-.12.28-.12h3.89c.11,0,.21.04.28.12.08.08.12.17.12.28v16.31c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12Z" />
                            <path d="M187.12,57.77c-.08-.08-.12-.17-.12-.28v-22.5c0-.11.04-.21.12-.28.08-.08.17-.12.28-.12h3.9c.11,0,.21.04.28.12.08.08.12.17.12.28v11.02c0,.09.02.14.07.15.04.01.09-.02.13-.08l2.9-5.03c.09-.18.25-.27.5-.27h4c.15,0,.26.04.32.13.05.09.04.2-.05.33l-3.59,5.59c-.04.09-.06.17-.03.23l4.06,10.35s.03.1.03.17c0,.2-.12.3-.37.3h-4.03c-.22,0-.37-.11-.43-.33l-2.13-6.59c-.02-.07-.06-.11-.1-.12-.04-.01-.08.02-.1.08l-1.1,1.73c-.04.09-.07.16-.07.2v4.63c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12Z" />
                            <path d="M208.96,40.89c.08-.08.17-.12.28-.12h3.89c.11,0,.21.04.28.12.08.08.12.17.12.28v15.91c0,2.46-.58,4.36-1.75,5.69-1.17,1.33-3.26,2-6.27,2-.6,0-1.07-.01-1.4-.03-.27-.02-.4-.17-.4-.43v-3.26c0-.29.14-.41.43-.37,1.31.04,2.3-.08,2.98-.38.68-.3,1.13-.75,1.37-1.35.23-.6.35-1.39.35-2.36,0-.07-.02-.1-.07-.1s-.09.03-.13.1c-.4.53-.88.9-1.45,1.12-.57.21-1.12.32-1.65.32-1.53,0-2.67-.49-3.43-1.48-.75-.99-1.13-2.36-1.13-4.11v-6.33c0-1.8.38-3.18,1.15-4.14.77-.97,1.9-1.45,3.41-1.45,1.35,0,2.38.5,3.1,1.5.04.07.09.09.13.07.04-.02.07-.07.07-.13v-.77c0-.11.04-.21.12-.28ZM208.39,53.42c.3-.35.45-.81.45-1.36v-5.63c0-.55-.15-1.01-.45-1.37-.3-.35-.68-.53-1.15-.53s-.84.18-1.13.53c-.29.36-.43.81-.43,1.37v5.63c0,.55.14,1.01.43,1.36.29.36.67.53,1.13.53s.85-.18,1.15-.53Z" />
                            <path d="M226.68,42.04c1.18,1.02,1.76,2.36,1.76,4.03v11.42c0,.11-.04.21-.12.28s-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-.73c0-.07-.02-.11-.07-.13-.04-.02-.09,0-.13.07-.73.93-1.86,1.42-3.4,1.46-1.29,0-2.4-.36-3.35-1.07-.94-.71-1.42-2.06-1.42-4.06s.57-3.48,1.71-4.26c1.14-.78,2.79-1.17,4.94-1.17h1.53c.11,0,.17-.06.17-.17v-.83c0-.6-.16-1.09-.48-1.48-.32-.39-.73-.58-1.21-.58-.38,0-.69.12-.95.35-.25.23-.42.56-.48.98-.02.27-.17.4-.43.4l-4-.03c-.27,0-.4-.13-.4-.4.11-1.62.74-2.91,1.9-3.88,1.15-.97,2.62-1.45,4.39-1.45,1.89,0,3.42.51,4.59,1.53ZM223.14,54.01c.41-.34.62-.8.62-1.38v-1.56c0-.11-.06-.17-.17-.17h-1.37c-.6,0-1.08.17-1.45.52s-.55.82-.55,1.42c0,.55.14.98.42,1.26.28.29.65.43,1.12.43.51,0,.97-.17,1.38-.52Z" />
                            <path d="M239.8,40.91c.18.11.24.28.2.5l-.63,3.9c-.02.24-.18.33-.47.27-.24-.09-.54-.13-.9-.13-.33,0-.62.04-.87.13-.51.09-.92.39-1.23.92-.31.52-.47,1.13-.47,1.81v9.15c0,.11-.04.21-.12.28s-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-16.28c0-.11.04-.21.12-.28s.17-.12.28-.12h3.9c.11,0,.21.04.28.12s.12.17.12.28v1.3c0,.09.02.14.05.15s.07-.02.12-.08c.6-1.31,1.53-1.96,2.8-1.96.6,0,1.06.11,1.4.33Z" />
                            <path d="M249.2,43.95c-.08.08-.17.12-.28.12h-1.86c-.11,0-.17.06-.17.17v7.92c0,.64.12,1.09.37,1.33.24.25.61.36,1.1.33h.23c.11,0,.21.04.28.12s.12.17.12.28v3.26c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-1.33c-1.62,0-2.84-.27-3.66-.82-.82-.54-1.23-1.58-1.23-3.11v-9.72c0-.11-.06-.17-.17-.17h-1.1c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-2.5c0-.11.04-.21.12-.28.08-.08.17-.12.28-.12h1.1c.11,0,.17-.06.17-.17v-3.69c0-.11.04-.21.12-.28s.17-.12.28-.12h3.73c.11,0,.21.04.28.12.08.08.12.17.12.28v3.69c0,.11.06.17.17.17h1.86c.11,0,.21.04.28.12.08.08.12.17.12.28v2.5c0,.11-.04.21-.12.28Z" />
                            <path d="M263.45,50.68c-.08.08-.17.12-.28.12h-7.32c-.11,0-.17.06-.17.17v1.23c0,.55.15,1.02.45,1.38.3.37.68.55,1.15.55.42,0,.77-.14,1.03-.42s.44-.63.53-1.05c.07-.22.21-.33.43-.33l3.83.2c.11,0,.21.04.28.12s.11.18.08.32c-.16,1.71-.75,3-1.78,3.88-1.03.88-2.5,1.32-4.41,1.32s-3.52-.49-4.63-1.48-1.66-2.36-1.66-4.11v-6.46c0-1.69.56-3.04,1.68-4.06,1.12-1.02,2.66-1.53,4.61-1.53s3.49.51,4.61,1.53c1.12,1.02,1.68,2.38,1.68,4.06v4.29c0,.11-.04.21-.12.28ZM256.12,45.07c-.3.36-.45.81-.45,1.37v1.3c0,.11.06.17.17.17h2.86c.11,0,.17-.06.17-.17v-1.3c0-.55-.15-1.01-.45-1.37-.3-.35-.68-.53-1.15-.53s-.85.18-1.15.53Z" />
                            <path d="M277.08,42.01c.75,1,1.13,2.4,1.13,4.19v11.29c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-10.92c0-.64-.13-1.14-.38-1.5-.26-.35-.63-.53-1.12-.53s-.9.18-1.18.55c-.28.37-.42.88-.42,1.55v10.85c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-16.31c0-.11.04-.21.12-.28s.17-.12.28-.12h3.9c.11,0,.21.04.28.12s.12.17.12.28v.63c0,.07.03.1.08.1s.13-.04.22-.13c.71-.84,1.7-1.26,2.96-1.26,1.51,0,2.64.5,3.4,1.5Z" />
                            <path d="M280.99,57.27c-.5-.5-.75-1.13-.75-1.88s.24-1.41.73-1.9c.49-.49,1.12-.73,1.9-.73s1.41.25,1.9.73c.49.49.73,1.12.73,1.9s-.25,1.38-.75,1.88-1.13.75-1.88.75-1.38-.25-1.88-.75Z" />
                            <path d="M289.18,56.65c-1.12-1-1.68-2.36-1.68-4.09v-6.46c0-1.69.56-3.04,1.68-4.06,1.12-1.02,2.66-1.53,4.61-1.53s3.49.5,4.61,1.5c1.12,1,1.68,2.3,1.68,3.89v.6c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12l-3.89.17c-.27,0-.4-.13-.4-.4v-.4c0-.49-.15-.9-.45-1.23-.3-.33-.68-.5-1.15-.5s-.88.18-1.17.53c-.29.36-.43.82-.43,1.4v5.73c0,.58.14,1.04.43,1.4.29.35.68.53,1.17.53s.85-.17,1.15-.52c.3-.34.45-.75.45-1.22v-.43c0-.11.04-.21.12-.28.08-.08.17-.12.28-.12l3.89.03c.11,0,.21.04.28.12.08.08.12.17.12.28v.77c0,1.64-.56,2.95-1.68,3.93-1.12.98-2.66,1.46-4.61,1.46s-3.49-.5-4.61-1.5Z" />
                            <path d="M313.53,42.01c.75,1,1.13,2.4,1.13,4.19v11.29c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.89c-.11,0-.21-.04-.28-.12s-.12-.17-.12-.28v-10.92c0-.64-.13-1.14-.38-1.5-.26-.35-.63-.53-1.12-.53s-.9.18-1.18.55c-.28.37-.42.88-.42,1.55v10.85c0,.11-.04.21-.12.28-.08.08-.17.12-.28.12h-3.9c-.11,0-.21-.04-.28-.12-.08-.08-.12-.17-.12-.28v-22.5c0-.11.04-.21.12-.28.08-.08.17-.12.28-.12h3.9c.11,0,.21.04.28.12.08.08.12.17.12.28v6.82c0,.07.03.1.08.1s.13-.04.22-.13c.71-.84,1.7-1.26,2.96-1.26,1.51,0,2.64.5,3.4,1.5Z" />
                        </g>
                    </svg>

                    <h1
                        style={{
                            fontSize: 82,
                            margin: '0 0 40px -2px',
                            lineHeight: 1.1,
                            textShadow: '0 2px 30px #000',
                            letterSpacing: -4,
                            color: '#fff'
                        }}
                    >
                        {title}
                    </h1>
                </div>
            ),
            {
                width: 1200,
                height: 630,
                // fonts: [
                //     {
                //         name: 'inter',
                //         data: await font,
                //         style: 'normal'
                //     }
                // ]
            }
        )
    } catch (error) {
        console.error(error)
        return new Response('Failed to generate the image', { status: 500 })
    }
}
